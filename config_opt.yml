# ğŸš€ é’ˆå¯¹RTX 4090æœåŠ¡å™¨ä¼˜åŒ–çš„GCPNeté…ç½®
project_name: "GCPNet_4090_hyperopt"
net: "GCPNet"
output_dir: "./output_4090"
self_loop: True
n_neighbors: 12
debug: False

netAttributes:
  firstUpdateLayers: 4
  secondUpdateLayers: 4
  atom_input_features: 105
  edge_input_features: 50
  triplet_input_features: 40
  embedding_features: 64
  hidden_features: 128                 # åŸºå‡†å€¼ï¼Œä¼šè¢«è¶…å‚æ•°æœç´¢è¦†ç›–
  output_features: 1
  min_edge_distance: 0.0
  max_edge_distance: 8.0
  link: "identity"
  batch_size: 64                       # åŸºå‡†å€¼ï¼Œä¼šè¢«è¶…å‚æ•°æœç´¢è¦†ç›–
  num_workers: 6                       # ğŸ”§ ä¼˜åŒ–ï¼šå¢åŠ åˆ°6ï¼ˆ4090æœåŠ¡å™¨é€šå¸¸æœ‰16æ ¸+ï¼‰
  dropout_rate: 0.1                    # åŸºå‡†å€¼ï¼Œä¼šè¢«è¶…å‚æ•°æœç´¢è¦†ç›–

hyperParameters:
  lr: 0.001                           # åŸºå‡†å€¼ï¼Œä¼šè¢«è¶…å‚æ•°æœç´¢è¦†ç›–
  optimizer: "AdamW"
  optimizer_args:
    weight_decay: 5.0e-5              # åŸºå‡†å€¼ï¼Œä¼šè¢«è¶…å‚æ•°æœç´¢è¦†ç›–
  scheduler: "ReduceLROnPlateau"
  scheduler_args:
    mode: "min"
    factor: 0.5
    patience: 8                       # ğŸ”§ ä¼˜åŒ–ï¼šé™ä½patienceï¼ˆä»10åˆ°8ï¼‰
    min_lr: 1.0e-6
    threshold: 0.0002
  seed: 666
  epochs: 30                          # ğŸ”§ ä¼˜åŒ–ï¼šé™ä½epochsï¼ˆä»100åˆ°30ï¼‰æ›´é€‚åˆè¶…å‚æ•°æœç´¢
  patience: 15                        # ğŸ”§ ä¼˜åŒ–ï¼šé™ä½patienceï¼ˆä»25åˆ°15ï¼‰

data:
  points: all
  dataset_path: './data'
  dataset_name: 'jarvis_fe_15k'
  target_name: 'formation_energy_peratom'
  pin_memory: True                    # 4090æ˜¾å­˜å¤§ï¼Œä¿æŒå¯ç”¨
  num_folds: 5

predict:
  model_path: 'model.pt'
  output_path: 'output.csv'

visualize_args:
  perplexity: 50
  early_exaggeration: 12
  learning_rate: 300
  n_iter: 5000
  verbose: 1
  random_state: 42

# ğŸš€ ä¼˜åŒ–åçš„Optunaè¶…å‚æ•°æœç´¢é…ç½®
optuna:
  n_trials: 100                       # ğŸ”§ ä¼˜åŒ–ï¼šå¢åŠ åˆ°100æ¬¡ï¼ˆ4090å¿«ï¼‰
  study_name: "GCPNet_4090_hyperopt"
  
  # ğŸ”§ æ–°å¢ï¼šæœç´¢ç©ºé—´é…ç½®ï¼ˆæœªæ¥æ‰©å±•ç”¨ï¼‰
  search_space:
    lr:
      type: "float"
      low: 0.0005
      high: 0.005                     # ğŸ”§ æ‰©å¤§å­¦ä¹ ç‡æœç´¢èŒƒå›´
      log: true
    dropout_rate:
      type: "float" 
      low: 0.05
      high: 0.3                       # ğŸ”§ æ‰©å¤§dropoutæœç´¢èŒƒå›´
    weight_decay:
      type: "float"
      low: 1.0e-6
      high: 1.0e-3
      log: true
    batch_size:
      type: "categorical"
      choices: [48, 64, 96, 128]      # ğŸ”§ 4090å¯ä»¥æ”¯æŒæ›´å¤§batch
    hidden_features:
      type: "categorical"
      choices: [96, 128, 160, 192, 224] # ğŸ”§ å¢åŠ æ›´å¤§çš„éšè—å±‚é€‰é¡¹
  
  # ğŸ”§ æ–°å¢ï¼šå‰ªæé…ç½®
  pruning:
    enable: true
    n_startup_trials: 5               # å‰5ä¸ªtrialä¸å‰ªæ
    n_warmup_steps: 5                 # å‰5ä¸ªepochä¸å‰ªæ
    interval_steps: 2                 # æ¯2ä¸ªepochæ£€æŸ¥ä¸€æ¬¡
  
  # ğŸ”§ æ–°å¢ï¼šç»­ä¼ é…ç½®
  resume:
    enable: true
    auto_detect: true                 # è‡ªåŠ¨æ£€æµ‹æœ€æ–°æ•°æ®åº“
    
wandb:
  log_enable: False                   # è¶…å‚æ•°æœç´¢æ—¶å…³é—­wandb
  sweep_count: 100                    # å¯¹åº”n_trials
  entity: "1548532425-null"

# ğŸ”§ æ–°å¢ï¼šç³»ç»Ÿä¼˜åŒ–é…ç½®
system:
  gpu:
    memory_fraction: 0.9              # ä½¿ç”¨90%çš„GPUå†…å­˜
    allow_growth: true                # å…è®¸åŠ¨æ€å¢é•¿
  cpu:
    max_workers_ratio: 0.5            # ä½¿ç”¨50%çš„CPUæ ¸å¿ƒ
  monitoring:
    log_interval: 10                  # æ¯10ä¸ªtrialè®°å½•ä¸€æ¬¡ç³»ç»ŸçŠ¶æ€
    save_interval: 5                  # æ¯5ä¸ªtrialä¿å­˜ä¸€æ¬¡æ£€æŸ¥ç‚¹